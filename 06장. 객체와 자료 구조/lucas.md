# 06장. 객체와 자료 구조

자료 추상화

자료/객체 비대칭

디미터 법칙

\_\_ 기차 충돌

\_\_ 잡종 구조

\_\_ 구조체 감추기

자료 전달 객체

\_\_ 활성 레코드

## ✏️ 정리본

- 변수를 비공개로 정의하지만, 조회 함수와 설정 함수를 공개하여 왜 비공개 변수를 외부에 노출하게 하는 걸까?

### 자료 추상화

- 변수를 private으로 선언하더라도 각 값마다 조회 함수와 설정 함수를 제공한다면 구현을 외부로 노출하는 셈
- 자료를 세세하게 공개하기보다는 추상적인 개념으로 표현하는 편이 좋다
- **개발자는 객체가 포함하는 자료를 표현할 가장 좋은 방법을 심각하게 고민해야 한다**

```java
// 구체적인 Vehical Class
public interface Vehicle{
  double getFuleTankCapacityInGallons()
  double getGallonsOfGasoline()
}

// 추상적인 Vehicle Class
public interface Vehicle{
  double getPercentFuleRemaing();
}
```

- 구현을 감추려면 추상화가 필요. 추상 인터페이스를 제공해 사용자가 구현을 모른 채 자료의 핵심을 조작할 수 있어야진정한 의미의 클래스이다.

### 자료/객체 비대칭

- 객체는 추상화 뒤로 자료를 숨긴 채 자료를 다루는 함수만 공개
- 자료 구조는 자료를 그대로 공개하여 별다른 함수를 제공하지 않음
- 객체와 자료 구조는 근본적으로 양분된다
  - (자료 구조를 사용하는) 절차적인 코드는 기존 자료 구조를 변경하지 않으면서 새 함수를 추가하기 쉽다. 반면, 객체 지향 코드는 기존 함수를 변경하지 않으면서 새 클래스를 추가하기 쉽다
  - 절차적인 코드는 새로운 자료 구조를 추가하기 어렵다. 그러려면 모든 함수를 고쳐야 한다. 객체 지향 코드는 새로운 함수를 추가하기 어렵다. 그러려면 모든 클래스를 고쳐야 한다.
- 새로운 자료 타입이 필요한 경우 => 클래스와 객체 지향 기법이 적절
- 새로운 함수가 필요한 경우 => 절차적인 코드와 자료 구조가 좀 더 적합

### 디미터 법칙

- 모듈은 자신이 조작하는 객체의 속사정을 몰라야 한다는 법칙

  - 객체는 자료를 숨기고 함수를 공개함

- 기차 충돌

  - 기차 충돌이란 => `final String outputDir = ctxt.getOptions().getScratchDir().getAbsolutePath();`
  - 일반적으로 조잡하다 여겨지는 방식이므로 피하는 편이 좋다

- 잡종 구조

  - 절반은 객체 + 절반은 자료 구조 => 잡종 구조
    - 중요한 기능을 수행하는 함수 존재, 공개 변수나 공개 조회, 설정 함수 조회 (비공개 변수 노출)
  - 양쪽의 단점만 모아놓은 구조이므로 되도록 피하는 편이 좋다

- 구조체 감추기

  - 객체라면 내부 구조를 감춰야 함으로 기차 충돌 같은 코드로 작성하면 안됨

    ```
    ctxt.getAbsolutePathOfScratchDirectoryOption();
    // ctxt 에게 공개해야 할 메서드 많음
    ctx.getScratchDirectoryOption().getAbsolutePath();
    //객체가 아니라 자료구조를 반환한다고 가정
    String outFile = outputDir + "/" + className.replace('.','/') + ".class";
    FileOutputStream fout = new FileOutputStream(outFile);
    BufferedOutputStream bos = new BufferedOutputStream(fout);
    //마지막 코드에서 임시 파일을 생성하기 위한 목적이라는 사실 알 수 있음
    BufferedOutputStream bos = ctxt.createScratchFileStream(classFileName);
    //ctxt 객체에 임시파일을 생성하라고 객체에게 맡김
    ```

### 자료 전달 객체

- 자료 구조의 전형적인 형태는 공개 변수만 있고 함수가 없는 클래스, 때로는 자료 전달 객체(DTO)라 하기도 함
- 데이터베이스와 통신하거나 소켓에서 받은 메시지의 구문을 분석할 때 유용
- 흔히 DTO는 데이터베이스에 저장된 가공되지 않은 정보를 애플리케이션 코드에서 사용할 객체로 변환하는 일련의 단계에서 가장 처음으로 사용하는 구조체임!

### 활성 레코드

- DTO의 특수한 형태
- DTO의 특수한 형태로 공개 변수가 있거나 비공개 변수에 조회, 설정 함수가 있는 자료 구조
- 활성 레코드를 잘못 사용하면 잡종 구조로 갈 확률이 높다 => 활성 레코드도 자료 구조로 취급하고, 비즈니스 규칙을 담으면서 내부 자료를 숨기는 객체는 따로 생성한다 (여기서 내부 자료는 활성 레코드의 인스턴스일 가능성이 높다)

### 결론

- 새로운 자료 타입을 추가하는 유연성이 필요하면 객체가 더 적합하다.
- 새로운 동작을 ㅊ추가하는 유연성이 필요하면 자료구조와 절차적인 코드가 더 적합하다.
