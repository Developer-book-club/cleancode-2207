# 09. 단위 테스트

## ✏️ 정리본

## **TDD 법칙 세 가지**

- **첫째 법칙:** 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.
- **둘째 법칙:** 컴파일은 실패하지 않으면서 실행이 실패하는 정도로만 단위 테스트를 작성한다.
- **셋째 법칙:** 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.

이렇게 일하다 보면, 실제코드와 맞먹는 테스트코드가 나오고 이것을 관리해야 되는 문제도 발생하기도 한다.

### 깨끗한 테스트 코드 유지하기

- 테스트 코드는 실제 코드 못지 않게 중요하고 실제 코드 못지 않게 깨끗하게 짜야 한다.
- 테스트 케이스가 없으면 개발자는 변경을 주저한다. 버그가 숨어들까 두렵기 때문이다.
- 테스트는 유연성, 유지보수성, 재사용성을 제공하는 것이 단위테스트 이다.

### 깨끗한 테스트 코드

- 테스트 코드에 중요한 것은 가독성!
- 최소한의 표현으로 많은 것을 표현해야 한다.
- 진짜 필요한 자료유형과 ㅎ ㅏㅁ수ㅁ
- BUILD-OPERATE-CHECK 패턴
  - 테스트 코드에 적합한 패턴
  - 첫째. 테스트 자료를 만든다.
  - 둘째. 테스트 자료를 조작한다.
  - 셋째. 조작한 결과가 올바른지 확인한다.
- 이중 언어
  - 테스트코드는 단순하고, 간결하고, 표현력이 풍부해야 하지만, 실제 코드만큼 효율적일 필요는 없다.

### 테스트 당 assert 하나

given-when-then

- **테스트를 분리하면 중복되는 코드가 많아진다.**
- **가장 좋은 규칙은 "개념 당 assert 문 수를 최소로 줄여라"와 "테스트 함수 하나는 개념 하나만 테스트하라"**

### given-when-then 관례

- 함수 이름에 이 관례를 적용함으로써 테스트 코드를 읽기 쉬워진다
- Given
  - 테스트에서 구체화하고자 하는 행동을 시작하기 전에 테스트 상태를 설명하는 부분
- When
  - 구체화하고자 하는 그 행동
- Then
  - 어떤 특정한 행동 때문에 발생할거라고 예상되는 변화에 대한 설명

### F.I.R.S.T

- **Fast(빠르게) :** 자주 돌리지 않으면 초반에 문제를 찾아내 고치지 못한다.
- **독립적으로Independent :**
  - 하나가 실패할 때 나머지도 잇달아 실패하므로 원인을 진단하기 어려워진다.
  - 각 테스트는 서로 의존하면 안 된다.( 독립적이기 때문에 어떤 순서로 실행해도 괜찮아야 한다.)
- **Repeatable(반복가능하게) :**
  - 테스트는 어떤 환경에서도 반복 가능해야 한다. 실제 환경, QA 환경, 버스를 타고 집으로 가는 길에 사용하는 노트북 환경(네트워크가 연결되지 않은)에서도 실행할 수 있어야 한다. 테스트가 돌아가지 않는 환경이 하나라도 있다면 테스트가 실패한 이유를 둘러댈 변명이 생긴다. 게다가 환경이 지원되지 않기에 테스트를 수행하지 못하는 상황에 직면한다.
  - 테스트가 돌아가지 않는 환경이 하나라도 있다면 테스트가 실패한 이유를 둘러댈 변명이 생긴다.
- **자가검증하는Self-Validating :**
  - 테스트는 bool값으로 결과를 내야 한다. 성공 아니면 실패다.
- **적시에Timely :**
  - 단위 테스트는 실제 코드를 구현하기 직전에 구현한다.
  - 실제 코드를 구현한 다음에 테스트 코드를 만들면 실제 코드가 테스트하기 어렵다는 사실을 발견할지도 모른다.
