11장 시스템
시스템의 생성과 사용을 분리하라
생성/사용의 분산은 모듈성을 저해하고 코드의 중복을 가져오므로 잘 정돈된 견고한 시스템을 만들기 위해서는 전역적이고 일관된 의존성 해결 방법을 통해 위와 같은 작은 편의 코드들이 모듈성의 저해를 가져오는 것을 막아야 한다.

생성 로직을 어플리케이션의 시작이 아닌 메인으로
생성과 사용을 분리하는 가장 간단한 방법은 모든 생성과 관련된 로직을 main으로 옮기는 것이다. 어플리케이션에서는 사용할 모등 객체들이 main에서 잘 생성되었을 것이라 여기고 나머지 디자인에 집중할 수 있다.

Untitled

팩토리 기법
객체의 생성 시기를 직접 결정하려면 main에서 완성된 객체를 던져주기보다 factory 객체를 만들어서 던져주자.만약 자세한 구현을 숨기고 싶다면 Abstract Factory 패턴을 사용하자.

Untitled

스케일링

도시를 건설할 때 처음부터 완벽하게 만들기는 힘들다. 소프트웨어 시스템 또한 마찬가지이다. 만약 우리가 Concern들을 적절히 분리할 수 있다면, 소프트웨어 시스템은 물리적인 시스템(ex, 도시건축)과는 다르게 점진적으로 커질 수 있다.

Cross-Cutting Concerns(관심 분야)
Cross-Cuttin Concerns란?
이론적으로는 독립된 형태로 구분될 수 있지만 실제로는 코드에 산재하기 쉬운 부분들을 뜻한다.(transaction, authorization, logging등)
시스템 아키텍쳐를 테스트 주도하라(Test Drive the System Architecture)
코드 레벨에서부터 아키텍쳐와 분리된 프로그램 작성은 당신의 아키텍쳐를 test drive하기 쉽게 만들어 준다. 처음에는 작고 간단한 구조에서 시작하지만 필요에 따라 새로운 기술을 추가해 정교한 아키텍쳐로 진화할 수 있다. 또초기 EJB와 같이 너무 많은 엔지니어링이 가미되어 많은 concern들을 묶어버리지 않으며 오히려 많은 부분들을 숨기는 것이 아름다운 구조를 가져올 것이다.

이상적인 시스템 아키텍쳐는 각각 POJO로 만들어진 모듈화된 관심 분야 영역(modularized domains of concern)으로 이루어져야 한다. 다른 영역끼리는 Aspect의 개념을 사용해 최소한의 간섭으로 통합되어야 한다. 이러한 아키텍쳐는 코드와 마찬가지로 test-driven될 수 있다.

의사 결정을 최적화하라
충분히 큰 시스템에서는 한 사람이 모든 결정을 내릴 수는 없다. 결정은 최대한 많은 정보가 모일 때까지 미루고 시기가 되었을 경우 해당 파트의 책임자(모듈화된 컴포넌트를 뜻한다)에게 맡기는 것이 불필요한 소통을 덜어줄 것이다.

모듈화된 관심 분야로 이루어진 POJO 시스템의 (변화에 대한)민첩함은 가장 최신의 정보를 가지고 적시에 최적의 선택을 할 수 있게 도와준다. 결정에 필요한 복잡도 또한 경감된다.

시스템에는 DSL(도메인 영역 언어)이 필요하다
좋은 DSL은 도메인 영역의 개념과 실제 구현될 코드 사이의 "소통의 간극"을 줄여 도메인 영역을 코드 구현으로 번역하는 데에 오역을 줄여준다. DSL을 효율적으로 사용하면 코드 덩어리와 디자인 패턴의 추상도를 높여 주며 그에 따라 코드의 의도를 적절한 추상화 레벨에서 표현할 수 있게 해준다.

DSL은 "모든 단계에서의 추상화"와 "모든 도메인의 POJO화"를 고차원적 규칙과 저차원적 디테일 전반에 걸쳐 도와 준다.